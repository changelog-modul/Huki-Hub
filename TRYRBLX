-- Services
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")

-- Variables
local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoid = character:WaitForChild("Humanoid")

-- Create ScreenGui
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "WalkSpeedGui"
screenGui.ResetOnSpawn = false
screenGui.Parent = player:WaitForChild("PlayerGui")

-- Create Frame
local frame = Instance.new("Frame")
frame.Size = UDim2.new(0, 200, 0, 100)
frame.Position = UDim2.new(0, 20, 0, 20)
frame.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
frame.BackgroundTransparency = 0.3
frame.BorderSizePixel = 0
frame.Parent = screenGui

-- Create Title Label
local titleLabel = Instance.new("TextLabel")
titleLabel.Size = UDim2.new(1, 0, 0, 25)
titleLabel.BackgroundTransparency = 1
titleLabel.Text = "WalkSpeed Controller"
titleLabel.TextColor3 = Color3.new(1, 1, 1)
titleLabel.Font = Enum.Font.SourceSansBold
titleLabel.TextSize = 18
titleLabel.Parent = frame

-- Create Slider Frame
local sliderFrame = Instance.new("Frame")
sliderFrame.Size = UDim2.new(1, -20, 0, 40)
sliderFrame.Position = UDim2.new(0, 10, 0, 40)
sliderFrame.BackgroundTransparency = 1
sliderFrame.Parent = frame

-- Create Slider Bar
local sliderBar = Instance.new("Frame")
sliderBar.Size = UDim2.new(1, 0, 0, 6)
sliderBar.Position = UDim2.new(0, 0, 0.5, -3)
sliderBar.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
sliderBar.Parent = sliderFrame

-- Create Slider Fill
local sliderFill = Instance.new("Frame")
sliderFill.Size = UDim2.new(0, 0, 1, 0)
sliderFill.BackgroundColor3 = Color3.fromRGB(0, 170, 255)
sliderFill.Parent = sliderBar

-- Create Slider Button
local sliderButton = Instance.new("ImageButton")
sliderButton.Size = UDim2.new(0, 20, 0, 20)
sliderButton.Position = UDim2.new(0, 0, 0.5, -10)
sliderButton.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
sliderButton.BackgroundTransparency = 1
sliderButton.Image = "rbxassetid://3570695787" -- Circle image
sliderButton.Parent = sliderBar

-- Create Value Label
local valueLabel = Instance.new("TextLabel")
valueLabel.Size = UDim2.new(1, 0, 0, 20)
valueLabel.Position = UDim2.new(0, 0, 1, 0)
valueLabel.BackgroundTransparency = 1
valueLabel.TextColor3 = Color3.new(1, 1, 1)
valueLabel.Font = Enum.Font.SourceSans
valueLabel.TextSize = 16
valueLabel.Text = "Speed: 16"
valueLabel.Parent = frame

-- Variables for slider
local minSpeed = 16
local maxSpeed = 100
local dragging = false

local function updateSpeed(inputPosX)
	local relativeX = math.clamp(inputPosX - sliderBar.AbsolutePosition.X, 0, sliderBar.AbsoluteSize.X)
	local percent = relativeX / sliderBar.AbsoluteSize.X
	sliderFill.Size = UDim2.new(percent, 0, 1, 0)
	sliderButton.Position = UDim2.new(percent, -10, 0.5, -10)
	local speed = math.floor(minSpeed + (maxSpeed - minSpeed) * percent + 0.5)
	valueLabel.Text = "Speed: "..speed
	humanoid.WalkSpeed = speed
end

sliderButton.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1 then
		dragging = true
	end
end)

sliderButton.InputEnded:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1 then
		dragging = false
	end
end)

UserInputService.InputChanged:Connect(function(input)
	if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
		updateSpeed(input.Position.X)
	end
end)

-- Initialize slider position to default WalkSpeed
local function initSlider()
	local defaultSpeed = humanoid.WalkSpeed
	local percent = (defaultSpeed - minSpeed) / (maxSpeed - minSpeed)
	percent = math.clamp(percent, 0, 1)
	sliderFill.Size = UDim2.new(percent, 0, 1, 0)
	sliderButton.Position = UDim2.new(percent, -10, 0.5, -10)
	valueLabel.Text = "Speed: "..defaultSpeed
end

initSlider()

-- Update humanoid reference if character respawns
player.CharacterAdded:Connect(function(char)
	character = char
	humanoid = character:WaitForChild("Humanoid")
	initSlider()
end)
